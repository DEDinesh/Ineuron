CREATE TABLE IF NOT EXISTS UNITSSOLD (PRODUCT_ID INT , 
                        PURCHASE_DATE DATE , UNITS INT);
TRUNCATE TABLE UNITSSOLD;
INSERT INTO UNITSSOLD  VALUES 
('1',"2019-02-25" ,'100'), ('1',"2019-03-01" ,'15'),
('2',"2019-02-10" ,'200'), ('2',"2019-03-22" ,'30');
SELECT * FROM UNITSSOLD;

DROP TABLE IF EXISTS PRICES;
CREATE TABLE IF NOT EXISTS PRICES (PRODUCT_ID INT , 
                        START_DATE DATE , END_DATE DATE , PRICE INT);
TRUNCATE TABLE PRICES;
INSERT INTO PRICES  VALUES 
('1',"2019-02-17", "2019-02-28" ,'5'), 
('1',"2019-03-01" ,"2019-03-22",'20'),
('2',"2019-02-01" ,"2019-02-20" ,'15'), 
('2',"2019-02-21" , "2019-03-31" ,'30');
SELECT * FROM PRICES;

SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE
FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID
WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE
GROUP BY U.PRODUCT_ID;